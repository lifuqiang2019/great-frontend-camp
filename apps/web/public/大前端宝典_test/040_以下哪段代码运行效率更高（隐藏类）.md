# 以下哪段代码运行效率更高（隐藏类）

```javascript
const obj1 = {  
a: 1  
}  
const obj2 = {  
a: 1  
}  
const obj3 = {  
a: 1  
}

```

```javascript
const obj1 = {  
a: 1  
}  
const obj2 = {  
b: 1  
}  
const obj3 = {  
c: 1  
}

```
- **左边效率更高，重用了 隐藏类（Hidden Class）**

```javascript
// 测试代码  
console.time('a');  
for (let i = 0; i < 1000000; ++i) {  
const obj = {};  
obj\['a'\] = i;  
}  
console.timeEnd('a');  
  
console.time('b');  
for (let i = 0; i < 1000000; ++i) {  
const obj = {};  
obj\[\`${i}\`\] = i;  
}  
console.timeEnd('b');

```
- JS 运行机制： 浏览器 -> 内核 -> JS 解析引擎

**浏览器**

**内核**

**JS 解析引擎**

chrome

早期 WebKit，现目前 Blink

V8

Mozilla Firefox

Gecko

SpiderMonkey

Edge

Chromium

Chakra / V8

Safari

Webkit

JavascriptCore

- 比较主流的 JS 引擎是 v8，这里假设是跑在 chrome 或 node 上，用的是 v8 引擎。
- V8 是一个 c++ 实现的 js 解析引擎，内部利用 隐藏类（Hidden Class） 的方式来存放 JS 对象。
- 隐藏类的特性是：多个 属性顺序一致 的 JS 对象，会重用同一个隐藏类，减少 new Class 的开销。
- 所以左边生成1个隐藏类，而右边生成3个隐藏类，因此左边代码性能更好。
- **指导代码编写习惯：** 定义对象或类时，尽可能保证属性顺序一致。

[12月12日.mov](https://internal-api-drive-stream.feishu.cn/space/api/box/stream/download/preview/T5p4bovCooIKJRxlfWgcEKICn9f?mount_point=docx_file&preview_type=16)
