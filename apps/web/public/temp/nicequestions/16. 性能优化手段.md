# 性能优化手段?

## 简短回答

性能优化没有银弹，全是细节。它是一个系统工程，覆盖了从“输入 URL”到“页面展示”的每一个环节。我们可以把优化手段归纳为三类：**减少请求次数**（合并、缓存）、**减小请求体积**（压缩、WebP）、**加快渲染速度**（重排重绘优化、异步脚本）。

---

## 1. 图片优化 (WebP + LazyLoad)

图片通常占据了页面 60% 以上的带宽。

```html
<!-- 响应式图片 + WebP 降级处理 -->
<picture>
  <!-- 如果浏览器支持 WebP，就加载这个 (体积小 30%) -->
  <source srcset="img.webp" type="image/webp">
  <!-- 兜底：不支持 WebP 就加载 JPG -->
  <source srcset="img.jpg" type="image/jpeg"> 
  <!-- loading="lazy": 只有滚动到可视区域才加载 -->
  <img src="img.jpg" loading="lazy" alt="Optimized Image">
</picture>
```

## 2. 脚本加载 (Defer vs Async)

JS 的加载和执行会阻塞 DOM 解析，导致白屏。

*   **<script defer>** (推荐)：并行下载，**等文档解析完**才执行。按顺序执行，不阻塞渲染。
*   **<script async>**：并行下载，**下载完立即执行**。执行顺序不确定，可能阻塞渲染。

## 3. 减少重排 (Reflow)

重排（Layout）比重绘（Repaint）开销大得多。我们要避免频繁触发重排。

```javascript
// Bad: 读写交替，触发多次重排 (Layout Thrashing)
const width = el.offsetWidth; // 读
el.style.width = width + 'px'; // 写
const height = el.offsetHeight; // 读
el.style.height = height + 'px'; // 写

// Good: 读写分离，或者使用 class 一次性修改
el.classList.add('new-style');
```
