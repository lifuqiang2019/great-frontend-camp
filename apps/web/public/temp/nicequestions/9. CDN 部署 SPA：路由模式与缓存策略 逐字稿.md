# CDN 部署 SPA：路由模式与缓存策略

## 面试官提问

"SPA 应用部署到 CDN 上，经常会遇到刷新 404 的问题，这个怎么解决？另外，你的静态资源缓存策略一般是怎么配的？"

## 面试高分回答 (逐字稿)

"部署 SPA 到 CDN，最经典的问题就是刷新页面报 404。

这是因为我们通常用的是 History 路由。用户访问 `/user`，CDN 上其实没有这个目录，只有一个 `index.html`。

所以核心配置是做 **Rewrite (重写)**。以 Nginx 为例，要配置 `try_files`，告诉服务器：如果你找不到这个文件，就统统返回 `index.html`，把路由管理权交给前端 JS。

另外是**缓存策略**。我的一般做法是：
`index.html` 设置 **No-Cache** (或者极短的缓存)，确保用户永远拿最新的入口。
而 JS/CSS 等静态资源，因为打包时文件名带 Hash，我会设置**强缓存 (Cache-Control: max-age=1年)**，最大化利用 CDN 缓存能力。"