# ESM 与 CommonJS 差异及互操作

## 面试官提问

"前端模块化标准有很多，CommonJS 和 ESM 有什么本质区别？特别是在引用机制上，两者有什么不一样？"

## 面试高分回答 (逐字稿)

"这两种模块化标准我都用过，它们最大的区别在于**加载机制**和**值的引用**。

CommonJS (CJS) 是 Node.js 的标准，它是**运行时加载**，同步执行的。它导出的值是**值的拷贝**。这意味着一旦输出了，模块内部的变化外部是不知道的。

而 ES Modules (ESM) 是浏览器和现在的标准，它是**编译时静态分析**，异步加载的。它导出的是**值的引用 (Live Binding)**。这意味着模块内部变量变了，外部导入的值也会跟着变。

正是因为 ESM 支持静态分析，所以工具链才能实现 **Tree Shaking**，把没用到的代码摇掉。在互操作方面，ESM 可以 import CJS，但 CJS 没法直接 require ESM，因为 ESM 是异步的。"